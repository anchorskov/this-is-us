{{/* layouts/account/preferences.html */}}
{{ define "main" }}
<section class="container p-6">
  <h1 class="text-2xl font-bold mb-4">ðŸŽ¯ Your Hot-Button Topics</h1>
  <p class="mb-6 text-gray-600">
    Select the topics you care most about to personalize your feed and receive relevant updates.
  </p>

  <!-- Intro banner (first-time users only) -->
  <div id="intro-banner"
       class="hidden bg-blue-100 border-l-4 border-blue-400 p-4 rounded mb-4">
    <p class="font-semibold">First time here?</p>
    <p>Select any topics that interest you, then click <em>Save Preferences</em>.</p>
  </div>

  <!-- Preferences Form -->
  <form id="preferences-form" class="mb-8 space-y-2">
    <!-- Spinner and Loading Message (Hidden by default) -->
    <div id="prefs-loading" class="hidden flex items-center justify-center mt-4 text-gray-600">
      <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      <span id="prefs-loading-message">Loading topics...</span>
    </div>

    <!-- Select-all control (JS hooks by ID) -->
    <div class="my-2">
      <button type="button" id="select-all-topics-btn"
              class="px-3 py-2 rounded bg-slate-800 text-white text-sm">
        Select all hot topics
      </button>
    </div>

    <!-- Hot-button check-boxes injected here -->
    <div id="topics-container" class="space-y-1"></div>

    <!-- Feedback Message Area -->
    <div id="prefs-feedback" class="mt-4 text-sm text-center hidden"></div>

    {{ partial "turnstile.html" . }}

    <!-- Save Button -->
    <div class="mt-6">
      <button type="submit" id="save-prefs-btn"
              class="bg-green-600 text-white px-4 py-2 rounded
                     hover:bg-green-700 transition">
        Save My Preferences
      </button>
    </div>
  </form>

 <!-- Request New Topic Form (Temporarily Disabled) -->
<div class="mt-12 pt-6 border-t border-gray-200 text-center">
  <h2 class="text-xl font-bold mb-3">ðŸš§ New Topic Requests</h2>
  <p class="text-gray-600 mb-2">
    We're currently upgrading this feature to improve transparency and reduce spam.
  </p>
  <p class="text-gray-600">
    In the meantime, feel free to email topic ideas to
    <a href="mailto:anchorskov@gmail.com" class="text-blue-600 underline">anchorskov@gmail.com</a>
  </p>
</div>

</section>
{{ end }}

{{/* --- scripts block: injected after </main> but before </body> ---- */}}
{{ define "scripts" }}
  <!-- Preferences bundle -->
  <script type="module" src="{{ "js/account/preferences.js" | relURL }}" defer></script>
{{ end }}
