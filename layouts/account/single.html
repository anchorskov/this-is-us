{{/* layouts/account/single.html */}}
{{ define "main" }}
<section class="max-w-2xl mx-auto p-4">
  <h1 class="text-2xl font-bold mb-4">ğŸ‘¤ Your Account</h1>
  <p class="mb-6 text-gray-600">Manage your profile, town hall posts, events, and settings.</p>

  <!-- ğŸ§¾ Profile Section -->
  <form id="account-form" class="space-y-6">
    <!-- Display Name -->
    <label class="block">
      <span class="text-gray-700">Display Name</span>
      <input id="account-name" name="displayName" class="form-input mt-1 block w-full" type="text" placeholder="Your name" autocomplete="name" />
    </label>

    <!-- City and State -->
    <div class="space-y-4">
      <label for="city" class="block text-sm font-medium">City</label>
      <input type="text" id="city" name="city" class="w-full border p-2 rounded" autocomplete="address-level2" />

      <label for="state" class="block text-sm font-medium">State</label>
      <input type="text" id="state" name="state" class="w-full border p-2 rounded" autocomplete="address-level1" />
    </div>

    <!-- Email -->
    <div class="flex flex-col">
      <label class="text-sm font-medium text-gray-600">Email</label>
      <p id="account-email" class="text-gray-800 mt-1">Loading...</p>
    </div>

    <!-- Joined -->
    <div class="flex flex-col">
      <label class="text-sm font-medium text-gray-600">Joined</label>
      <p id="account-joined" class="text-gray-800 mt-1">Loading...</p>
    </div>

    <!-- Role -->
    <div class="flex flex-col">
      <label class="text-sm font-medium text-gray-600">Role</label>
      <p id="account-role" class="text-gray-800 mt-1">Loading...</p>
    </div>

    <!-- ğŸ“° Preferences -->
    <div class="mt-6">
      <label class="inline-flex items-center">
        <input id="account-newsletter" name="newsletter" type="checkbox" class="form-checkbox" />
        <span class="ml-2 text-gray-700">Receive Newsletter?</span>
      </label>
    </div>

    <!-- âš™ï¸ Buttons -->
    <div class="mt-6 flex flex-wrap gap-4">
      <button id="save-profile-btn" type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">
        Save Changes
      </button>
      <button id="delete-account-btn" type="button" class="text-red-600 border border-red-600 px-3 py-1.5 rounded hover:bg-red-50 hover:text-red-700 transition">
        Delete My Account
      </button>
    </div>
  </form>

  <!-- ğŸ› ï¸ Admin Panel (inline block) -->
  <div id="admin-panel" class="mt-12 hidden">
    <h2 class="text-xl font-semibold mb-3 text-red-700">ğŸ› ï¸ Admin Panel</h2>
    <p class="text-sm text-gray-600 mb-4">You have administrator privileges. From here, you can moderate posts, assign roles, and manage the database.</p>
    <div class="space-y-2">
      <a href="/admin/threads/" class="block px-4 py-2 rounded bg-red-100 hover:bg-red-200 text-red-800 font-medium w-max">ğŸ§µ Manage Threads</a>
      <a href="/admin/users/" class="block px-4 py-2 rounded bg-red-100 hover:bg-red-200 text-red-800 font-medium w-max">ğŸ‘¥ Manage Users</a>
    </div>
  </div>

  <!-- âœ… Feedback -->
  <div id="account-feedback" class="mt-4 text-sm text-center hidden text-green-600">Saving changes...</div>

  <!-- ğŸ›¡ï¸ Admin Panel (aside block) -->
  <aside id="admin-tools" class="hidden mt-10 border-t pt-6">
    <h2 class="text-xl font-bold text-red-700 mb-4">ğŸ›¡ï¸ Admin Tools</h2>
    <div class="space-y-4">
      <p class="text-gray-800">Welcome, administrator. From here you can:</p>
      <ul class="list-disc list-inside text-gray-700">
        <li>ğŸ” View and moderate all town hall threads</li>
        <li>ğŸ‘¥ Promote or demote user roles</li>
        <li>ğŸ—‚ï¸ Access event submissions for review</li>
      </ul>
      <a href="/admin/threads/" class="inline-block mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition">
        Manage Threads
      </a>
    </div>
  </aside>
</section>

<!-- ğŸ“œ Account Script -->
<script src="/js/account.js" defer></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    if (window.currentUserRole === "admin") {
      const adminPanel = document.getElementById("admin-panel");
      const adminTools = document.getElementById("admin-tools");
      if (adminPanel) adminPanel.classList.remove("hidden");
      if (adminTools) adminTools.classList.remove("hidden");
    }
  });
</script>
{{ end }}
