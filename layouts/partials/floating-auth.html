<!-- layouts/partials/floating-auth.html -->

<div id="floating-auth" style="
  display: none;
  position: fixed;
  top: 1rem;
  right: 1rem;
  z-index: 1000;
">
  <button id="auth-btn" class="auth-btn">...</button>
</div>

<script>
  console.log("ðŸ”¥ floating-auth partial script loaded");

  (function () {
    const container = document.getElementById("floating-auth");
    const btn = document.getElementById("auth-btn");

    if (!container || typeof firebase === "undefined" || !firebase.auth) {
      console.log("âš ï¸ Firebase not ready, skipping floating-auth");
      return;
    }

    // Ensure DOM is loaded before manipulating
    document.addEventListener("DOMContentLoaded", function () {
      setTimeout(() => {
        container.style.display = "block";
        console.log("ðŸ”² floating-auth: shown");
      }, 2000);

      firebase.auth().onAuthStateChanged(user => {
        if (user) {
          console.log("ðŸ‘¤ Logged in:", user.email || user.phoneNumber);
          btn.textContent = "Logout";
          btn.onclick = () => firebase.auth().signOut().then(() => location.reload());
        } else {
          console.log("ðŸ”’ Not signed in");
          btn.textContent = "Login";
          btn.onclick = () => {
            location.href = "/login/";
          };
        }
      });
    });
  })();
</script>

<style>
  .auth-btn {
    background: var(--tertiary, #1f2937);
    border: none;
    border-radius: 0.5rem;
    padding: 0.5rem 1.25rem;
    color: #fff;
    font-size: 1rem;
    cursor: pointer;
  }
</style>
