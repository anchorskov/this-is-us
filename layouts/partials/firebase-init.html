<!-- layouts/partials/firebase-init.html -->
<script>console.log('ğŸ”¥ firebase-init partial loaded');</script>

<!-- â€”â€”â€” Firebase core + services (v8 compat) â€”â€”â€” -->
<script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.min.js"></script>
<script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.min.js"></script>
<script defer src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.min.js"></script>

<!-- â€”â€”â€” FirebaseUI (styles + widget) â€”â€”â€” -->
<link
  rel="stylesheet"
  href="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.css"
  integrity="sha384-VxpY1rcHmlF+g12v7zFdLp/4e7iqB1DwSdyz+ZTzp8h6kIg3wvxxuG6mU9cA3+38"
  crossorigin="anonymous"
/>
<script defer src="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.min.js"></script>

<!-- â€”â€”â€” Project helpers (load after core libs) â€”â€”â€” -->
<script defer src="/js/firebase-config.js"></script>
<script defer src="/js/firebase-ui-config.js"></script>
<script defer src="/js/firebase-login.js"></script>
<script defer src="/js/firebase-session.js"></script>
<script defer src="/js/firebase-idle-logout.js"></script>

<!-- â€”â€”â€” Early auth status check â€”â€”â€” -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Make sure the SDK has both loaded *and* been initialised
    if (window.firebase?.apps?.length) {
      firebase.auth().onAuthStateChanged((user) => {
        window.currentUser = user || null;

        if (user) {
          console.log(
            'ğŸŸ¢ firebase-init: Logged in as',
            user.email ?? user.phoneNumber ?? '(no identifier)'
          );
        } else {
          console.log('ğŸ”´ firebase-init: No user signed in');
        }
      });
    } else {
      console.warn('âš ï¸ firebase-init: Firebase SDK not ready yet');
    }
  });
</script>
